在JavaScript中，我们的异步编程主要会产生两种任务，一种是微任务，一种是宏任务。

在说微任务和宏任务之前，我们先要了解，V8对于JavaScript的事件循环，采用了一个消息队列来存放事件，当一个事件被调用时，就把事件推入到消息队列的尾部，而当前事件执行完，就从队列头推出一个事件来执行，利用队列先进先出的特点，保证了事件的顺序执行。

而宏任务，其实就可以看做是在消息队列里等待被执行的任务。每个宏任务在执行时，V8都会重新创建栈，然后随着宏任务中函数调用，栈也随之变化，最终，当该宏任务执行结束时，整个栈又会被清空，接着主线程继续执行下一个宏任务。

相对来说，微任务会复杂一点，它指的是在主线程执行的任务之后，宏任务之前执行的任务，其实也就是两个宏任务之间的一个微小的任务。

之所以要引入微任务，是因为宏任务在执行的时候，相对来说较大，不适用一些对精度和实时性要求较高的场景。微任务可以在实时性和效率之间做一个权衡，此外，因为微任务的存在，我们可以使用同步的形式来编写我们的异步代码。

那么，接下来就来仔细地解析微任务，首先，我们要对微任务相关的一些基础知识做一个深入理解。

